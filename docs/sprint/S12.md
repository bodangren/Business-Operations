# Sprint 12 – Component Refactor

**Focus:** Establish a shared scenario data layer and align interactive tooling for Unit 1 while preparing the architecture for all 80 lessons.

## Anchor Issues
- [ ] **#14 – Define Unit 1 Lesson 1 component scenarios** *(backbone)*
  - Introduce typed lesson/phase scenario definitions under `src/types/lesson-scenarios.ts`.
  - Populate Unit 1 Lesson 1 data in `src/data/scenarios/unit01/lesson01.ts` with narrative copy, interactive configs, datasets, and teacher metadata.
  - Add scenario registry helpers (`getLessonScenario`, `hasLessonScenario`) with descriptive errors for unmigrated lessons.
  - Update barrel exports under `@/data/scenarios` for clean imports.
- [ ] **#19 – Refactor ErrorCheckingSystem for scenario-driven props**
  - Consume shared scenario data to configure ErrorCheckingSystem without duplicated JSON blobs.
  - Ensure unit/lesson datasets map cleanly to ErrorCheckingSystem props.
  - Document refactor in MCP knowledge base.
- [ ] **#20 – Create hook simulation registry for lesson introductions**
  - Centralize hook simulations (videos, prompts, datasets) in the scenario registry.
  - Provide lookup helpers for student + teacher surfaces.
- [ ] **#21 – Build Shoebox Challenge simulation for Unit 2 Lesson 1**
  - Extend scenario data pattern to Unit 2 with advanced simulation props.
  - Align interactive components with new typed schemas.
- [ ] **#22 – Activate spreadsheet helper playbooks for guided practice**
  - Wire spreadsheet helper configs to scenario entries for guided practice phases.
  - Ensure practice datasets are referenced from `/public/resources`.
- [ ] **#23 – Enhance component usage dashboard with phase analytics**
  - Instrument analytics to read from the scenario registry and surface by-unit usage stats.

## Dependencies & Sequencing
1. **Issue #14** creates the typed schema and first scenario implementation; all other issues depend on this backbone.
2. **Issue #19** validates the schema against a complex interactive component (ErrorCheckingSystem).
3. **Issue #20** and **#22** layer additional scenario consumers (hook simulations, spreadsheet helpers).
4. **Issue #21** expands the registry pattern to Unit 2, testing scalability across units.
5. **Issue #23** consumes scenario metadata to produce analytics and surface adoption gaps.

## Deliverables Checklist
- [ ] Shared scenario type definitions with discriminated unions for phase components.
- [ ] Unit 1 Lesson 1 scenario data populated and lint-clean.
- [ ] Scenario registry helpers + barrel exports under `@/data/scenarios`.
- [ ] Documentation updates in MCP knowledge base for new types and data modules.
- [ ] Consumer refactors (ErrorCheckingSystem, hook simulations, spreadsheet helpers) reading from shared data.
- [ ] Component usage dashboard updated to read from scenario registry.

## Testing Expectations
- `npm run lint` and `tsc --noEmit` before each commit touching scenario data or types.
- Manual navigation of student and teacher Unit 1 Lesson 1 routes after scenario wiring.
- Chrome MCP smoke tests for interactive components once consumers are refactored (#19/#22).
- JSON/TS data linting: ensure resource paths resolve and transcripts remain accessible.

## Open Questions / Notes
- Finalize how teacher-only metadata (presenter notes, timing) is stored without leaking to student surfaces.
- Confirm naming convention for scenario directories (`src/data/scenarios/unitXX/lessonYY.ts`) before scaling beyond Unit 1.
- Determine whether scenario content should remain plain strings or move toward structured rich-text blocks for slide generation.
- MCP documentation must be updated immediately after each new scenario type or data module is introduced.
