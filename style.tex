%===============================================================================
% style.tex - Global Style Definitions for Business Math & Finance Textbook
%===============================================================================

%===============================================================================
% 1. Package Imports & Global Settings
%===============================================================================
\usepackage[T1]{fontenc}
\usepackage{lmodern}                        % clean, scalable fonts
\usepackage[margin=1in]{geometry}
\usepackage{titlesec}                       % custom section titles
\usepackage{enumitem}                       % control list spacing
\usepackage[table]{xcolor}                  % color + table support
\usepackage{array}                          % table tweaks
\usepackage{tcolorbox}                      % for callout boxes
  \tcbuselibrary{skins,breakable}
\usepackage{marginnote}                     % for marginal notes
\usepackage{hyperref}                       % hyperlinks
\usepackage{makeidx}                        % for indexing key terms
  \makeindex
\usepackage{fontawesome}                    % provides \faInfoCircle, \faLightbulbO, etc.
% graphics for cover
\usepackage{graphicx}
\graphicspath{{images/}}
% Friendly defaults
\renewcommand{\familydefault}{\sfdefault}    % use sans‐serif by default
\setlength{\parskip}{0.5\baselineskip}       % space between paragraphs
\setlength{\parindent}{0pt}                 % no paragraph indent

% Example:
% Body text will now be sans‐serif, with 0.5 \baselineskip between paragraphs,
% and no indentation at the start of each paragraph.

%===============================================================================
% 2. Section Heading Styles
%===============================================================================
\titleformat{\section}
  {\Large\bfseries\sffamily}
  {\thesection}{1em}{}
\titlespacing*{\section}{0pt}{*2}{*1}

\titleformat{\subsection}
  {\normalsize\bfseries\sffamily}
  {\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{*1.5}{*0.75}

% Examples:
% \section{Driving Question}
% \subsection{Key Knowledge & Skills}

%===============================================================================
% 3. Callout Colors & Environments (with icons)
%===============================================================================
\definecolor{cbgImportant}{RGB}{255,245,200}
\definecolor{cframeImportant}{RGB}{255,165,0}
\definecolor{cbgTip}{RGB}{220,235,252}
\definecolor{cframeTip}{RGB}{30,144,255}
\definecolor{cbgTrivia}{RGB}{240,230,250}
\definecolor{cframeTrivia}{RGB}{148,0,211}
\definecolor{cbgWarning}{RGB}{255,228,225}
\definecolor{cframeWarning}{RGB}{255,69,0}
\definecolor{cbgExample}{RGB}{228,255,228}
\definecolor{cframeExample}{RGB}{34,139,34}
\definecolor{cframeReplace}{RGB}{255,69,69}
\definecolor{cbgReplace}{RGB}{255,194,194}

\newtcolorbox{Important}{
  breakable,
  colback=cbgImportant,
  colframe=cframeImportant,
  title={\faInfoCircle\ Important},
  fonttitle=\bfseries\sffamily,
  boxrule=0.8pt,
  arc=2pt
}
% Example:
% \begin{Important}
%   Always save a backup copy of your spreadsheet before making bulk changes.
% \end{Important}

\newtcolorbox{Tip}{
  breakable,
  colback=cbgTip,
  colframe=cframeTip,
  title={\faLightbulbO\ Tip},
  fonttitle=\bfseries\sffamily,
  boxrule=0.5pt,
  arc=2pt
}
% Example:
% \begin{Tip}
%   Press \texttt{Ctrl+;} in Excel to enter today’s date into a cell.
% \end{Tip}

\newtcolorbox{Trivia}{
  breakable,
  colback=cbgTrivia,
  colframe=cframeTrivia,
  title={\faQuestionCircleO\ Trivia},
  fonttitle=\bfseries\sffamily,
  boxrule=0.5pt,
  arc=2pt
}
% Example:
% \begin{Trivia}
%   Excel was first released in 1985 for the Macintosh.
% \end{Trivia}

\newtcolorbox{Warning}{
  breakable,
  colback=cbgWarning,
  colframe=cframeWarning,
  title={\faExclamationTriangle\ Warning},
  fonttitle=\bfseries\sffamily,
  boxrule=0.8pt,
  arc=2pt
}
% Example:
% \begin{Warning}
%   Avoid circular references unless you explicitly enable iterative calculation.
% \end{Warning}

\newtcolorbox{Example}{
  breakable,
  colback=cbgExample,
  colframe=cframeExample,
  title={\faCheckCircleO\ Example},
  fonttitle=\bfseries\sffamily,
  boxrule=0.5pt,
  arc=2pt
}
% Example:
% \begin{Example}
%   To sum cells B2 through B10, enter \excelformula{=SUM(B2:B10)} in the formula bar.
% \end{Example}

\newtcolorbox{Definition}{
  breakable,
  colback=white,
  colframe=blue!50!black,
  title={\faBook\ Definition},
  fonttitle=\bfseries\sffamily,
  boxrule=0.5pt,
  arc=2pt
}
% Example:
% \begin{Definition}
%   A \KeyTerm{Balance Sheet} is a financial statement showing assets, liabilities, and equity at a point in time.
% \end{Definition}

% Skill Box for Key Knowledge & Skills

\newtcolorbox{skillbox}[1][]{
  enhanced,
  sharp corners,
  boxrule=0.8pt,
  colback=yellow!10,            % light yellow background
  colframe=yellow!80!black,     % darker yellow frame
  coltitle=black,
  fonttitle=\bfseries,
  title={#1},
  attach boxed title to top left={
    yshift=-2mm,
    xshift=2mm
  },
  boxed title style={
    colback=yellow!80!black,
    sharp corners,
    boxrule=0pt,
    frame hidden
  },
  left=1mm, right=1mm, top=1mm, bottom=1mm,
  breakable
}

\newtcolorbox{Replace}{
  breakable,
  colback=cbgReplace,
  colframe=cframeReplace,
  title={\faInfoCircle Replace},
  fonttitle=\bfseries\sffamily,
  boxrule=0.5pt,
  arc=2pt
}
% Example:
% \begin{Tip}
%   Press \texttt{Ctrl+;} in Excel to enter today’s date into a cell.
% \end{Tip}

% Unit Entry Event callout (defined in style.tex)
\newcommand{\unitEntryEvent}[1]{%
  \begin{Replace}
  \textbf{Alert} #1
  \end{Replace}
}

%===============================================================================
% 4. Key Term Highlighting
%===============================================================================
\newcommand{\KeyTerm}[1]{%
  \textbf{\textsf{#1}}%
  \index{#1}%
}
% Example:
% A \KeyTerm{Depreciation} schedule shows asset value decline over time.

%===============================================================================
% 5. Excel-Style Table & Formula Bar
%===============================================================================
% Excel-like colors
\definecolor{excelHeaderBg}{RGB}{217,217,217}
\definecolor{excelBorder}{RGB}{191,191,191}
\definecolor{excelSelected}{RGB}{180,198,231}
\definecolor{excelFormula}{RGB}{0,0,255}
\definecolor{excelError}{RGB}{255,0,0}
\definecolor{excelCondRed}{RGB}{255,199,206}
\definecolor{excelCondGreen}{RGB}{198,239,206}
\definecolor{excelCondYellow}{RGB}{255,235,156}

% Table environment
\newenvironment{exceltable}{%
  \begin{center}
  \setlength{\arrayrulewidth}{0.5pt}%
  \arrayrulecolor{excelBorder}%
}{%
  \end{center}
}
% Example:
% \begin{exceltable}
%   \begin{tabular}{|c|c|c|c|}
%   \hline
%   \excelcolhead{} & \excelcolhead{A} & \excelcolhead{B} & \excelcolhead{C} \\\hline
%   \excelrowhead{1} & Item  & Qty & Price \\\hline
%   \excelrowhead{2} & Pens  & 50  & \excelcondgreen{\$25.00} \\\hline
%   \end{tabular}
% \end{exceltable}

% Header & cell macros
\newcommand{\excelcolhead}[1]{\cellcolor{excelHeaderBg}\textbf{#1}}
\newcommand{\excelrowhead}[1]{\cellcolor{excelHeaderBg}\textbf{#1}}
\newcommand{\excelformula}[1]{\texttt{\textcolor{excelFormula}{#1}}}
\newcommand{\excelselected}[1]{\cellcolor{excelSelected}#1}
\newcommand{\excelerror}[1]{\textcolor{excelError}{#1}}
\newcommand{\excelcondred}[1]{\cellcolor{excelCondRed}{#1}}
\newcommand{\excelcondgreen}[1]{\cellcolor{excelCondGreen}{#1}}
\newcommand{\excelcondyellow}[1]{\cellcolor{excelCondYellow}{#1}}
% Example:
% \excelformula{=SUM(B2:B10)}
% \excelselected{\$75.00}
% \excelerror{#DIV/0!}

% Formula bar box
\newtcolorbox{FormulaBar}{
  colback=gray!10,
  colframe=excelBorder,
  arc=0pt,
  boxrule=0.5pt,
  fontupper=\ttfamily\color{excelFormula},
  left=1mm,right=1mm,top=1mm,bottom=1mm
}
\newcommand{\excelformulabar}[1]{\begin{FormulaBar}#1\end{FormulaBar}}
% Example:
% \excelformulabar{=AVERAGE(B2:B8)}

%===============================================================================
% Now just \input this file from your main.tex (or section main.tex),
% and all styles (with usage docs) will be available.
%===============================================================================
